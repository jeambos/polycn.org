import React, { useState, useMemo } from 'react';
import '../../styles/Quiz.css';
import { WelcomeCard, QuizContainer, QuizFooter } from './ui/QuizFrame';
import CaseReactionPager from './ui/CaseReactionPager';
import RadarChart from './ui/RadarChart';
import { ScoreCard, ResultAnalysis, ResultActions } from './ui/ResultDashboard';

// =====================================================================
// 1. æ•°æ®å®šä¹‰
// =====================================================================
const DIMENSIONS = {
  competitive: { name: "ç«äº‰å‹", desc: "å‘ä¸Šæ¯”è¾ƒï¼šæ‹…å¿ƒæŠ€ä¸å¦‚äºº" },
  self_esteem: { name: "è‡ªå°Šå‹", desc: "å‘ä¸‹æ¯”è¾ƒï¼šæ„Ÿåˆ°å“å‘³å—è¾±" },
  normative: { name: "è§‚å¿µå‹", desc: "è¶…æˆ‘å®¡åˆ¤ï¼šç”Ÿç†æ€§åŒæ¶" },
  abandonment: { name: "é—å¼ƒå‹", desc: "ä¾æ‹æ–­è£‚ï¼šææƒ§è¿æ¥æ¶ˆå¤±" },
  exclusion: { name: "æ’æ–¥å‹", desc: "ä¿¡æ¯éš”ç¦»ï¼šå±€å¤–äººç„¦è™‘" },
  territorial: { name: "é¢†åœ°å‹", desc: "èµ„æºå¤±æ§ï¼šæƒç›Šè¢«ä¾µå " },
  projective: { name: "æŠ•å°„å‹", desc: "é˜´å½±æŠ•å°„ï¼šè‡ªèº«æ¬²æœ›é•œåƒ" }
};

const FEEDBACK_DATA = {
  competitive: {
    high: { desc: "ä½ ç»å¸¸æ‹…å¿ƒè‡ªå·±â€œä¸å¤Ÿå¥½â€ã€‚ä¸€æ—¦ä¼´ä¾£å¤¸å¥–åˆ«äººï¼Œä½ å°±ä¼šå®³æ€•è‡ªå·±è¢«æ¯”ä¸‹å»ï¼Œä»è€Œå¤±å»ä¼´ä¾£çš„çˆ±ã€‚", adv: "çˆ±ä¸æ˜¯æ¯”èµ›ï¼Œæ²¡æœ‰è¾“èµ¢ã€‚ä¼´ä¾£é€‰æ‹©ä½ ï¼Œæ˜¯å› ä¸ºä½ æ˜¯ç‹¬ä¸€æ— äºŒçš„ä½ ï¼Œè€Œä¸æ˜¯å› ä¸ºä½ åœ¨å„é¡¹æŒ‡æ ‡ä¸Šéƒ½æ‰“è´¥äº†æ‰€æœ‰äººã€‚" },
    mid: { desc: "ä½ å¶å°”ä¼šæ‹¿è‡ªå·±å’Œåˆ«äººæ¯”è¾ƒï¼Œæ‹…å¿ƒè‡ªå·±æ²¡æœ‰å¸å¼•åŠ›ã€‚", adv: "å¤šå…³æ³¨é‚£äº›åªæœ‰ä½ èƒ½ç»™ä¼´ä¾£å¸¦æ¥çš„ç‹¬ç‰¹ä»·å€¼ã€‚" },
    low: { desc: "ä½ å¯¹è‡ªå·±å¾ˆæœ‰è‡ªä¿¡ï¼Œä¸æ€ä¹ˆæ‹…å¿ƒè¢«åˆ«äººå–ä»£ã€‚", adv: "ä¿æŒè¿™ç§è‡ªä¿¡ï¼Œè¿™æ˜¯å…³ç³»ç¨³å®šçš„åŸºçŸ³ã€‚" }
  },
  self_esteem: {
    high: { desc: "ä½ å¾ˆåœ¨æ„ä¼´ä¾£è°ˆæ‹çˆ±çš„â€œå“å‘³â€ã€‚å¦‚æœä¼´ä¾£æ‰¾äº†ä¸€ä¸ªä½ è§‰å¾—å¾ˆå·®åŠ²çš„äººï¼Œä½ ä¼šè§‰å¾—è¿™ä¹Ÿæ˜¯åœ¨é™ä½ä½ çš„æ¡£æ¬¡ã€‚", adv: "è¯•ç€æŠŠâ€œä¼´ä¾£çš„è¡Œä¸ºâ€å’Œâ€œä½ çš„ä»·å€¼â€åˆ†å¼€ã€‚ta å–œæ¬¢è°æ˜¯ ta çš„è‡ªç”±ï¼Œå¹¶ä¸ä»£è¡¨ä½ ä¹Ÿæ˜¯é‚£ç§æ¡£æ¬¡ã€‚" },
    mid: { desc: "ä½ æœ‰ç‚¹è‡ªå°Šå¿ƒè¿‡å¼ºï¼Œæ€•ä¼´ä¾£é€‰çš„äººæ¯”ä½ å·®ã€‚", adv: "ä¼´ä¾£çš„å†³ç­–å¯èƒ½æœ‰å…¶ç†ç”±ï¼Œæ²¡æœ‰äººæ‹¿ä½ è·Ÿåˆ«äººæ¯”ï¼Œåˆ«å¤ªç´¯ã€‚" },
    low: { desc: "ä½ ä¸å¤ªæŠŠè‡ªå°Šå»ºç«‹åœ¨ä¼´ä¾£çš„é€‰æ‹©ä¸Šã€‚", adv: "ç»§ç»­ä¿æŒ~ æ”¾è¿‡åˆ«äººä¹Ÿæ”¾è¿‡è‡ªå·±ï¼ŒæŒºå¥½çš„ï¼" }
  },
  normative: {
    high: { desc: "ä½ å¯¹éå•å¶è¡Œä¸ºæœ‰å¼ºçƒˆçš„ç”Ÿç†æ€§æŠ—æ‹’ã€‚å³ä½¿ç†æ™ºä¸Šæƒ³å°è¯•ï¼Œå†…å¿ƒæ·±å¤„è§‰å¾—è¿™â€œä¸é“å¾·â€æˆ–â€œè„â€ã€‚", adv: "ä¸è¦å¼ºè¿«è‡ªå·±â€œå˜å¾—å¼€æ”¾â€ã€‚è¿™ç§æ¶å¿ƒæ„Ÿæ˜¯ä½ åœ¨ä¿æŠ¤è‡ªå·±ã€‚è¯·æ…¢ä¸‹æ¥ï¼Œé‡æ–°å®¡è§†è¿™ç§å…³ç³»æ¨¡å¼æ˜¯å¦çœŸçš„é€‚åˆç°åœ¨çš„ä½ ã€‚" },
    mid: { desc: "çœ‹åˆ°ä¸€äº›å‡ºæ ¼çš„è¡Œä¸ºï¼Œä½ å¿ƒé‡Œè¿˜æ˜¯ä¼šå’¯å™”ä¸€ä¸‹ã€‚", adv: "é—®é—®è‡ªå·±ï¼Œè¿™äº›è§„çŸ©æ˜¯ä½ æƒ³è¦çš„ï¼Œè¿˜æ˜¯åˆ«äººæ•™ä½ çš„ï¼Ÿ" },
    low: { desc: "ä½ å¿ƒæ€å¾ˆå¼€æ”¾ï¼Œä¸å¤ªå—ä¼ ç»Ÿé“å¾·æ¡†æ¶çš„æŸç¼šã€‚", adv: "ç¡®ä¿è¿™ç§å¼€æ”¾æ˜¯å‡ºäºçœŸå¿ƒï¼Œè€Œä¸æ˜¯ä¸ºäº†è¿åˆå¯¹æ–¹ã€‚" }
  },
  abandonment: {
    high: { desc: "ä½ æåº¦å®³æ€•è¢«æŠ›å¼ƒã€‚åªè¦ä¼´ä¾£çš„æ³¨æ„åŠ›ä¸åœ¨ä½ èº«ä¸Šï¼Œä½ å°±ä¼šææ…Œï¼Œè§‰å¾— ta ä¸çˆ±ä½ äº†ã€‚", adv: "è¯•ç€ç»ƒä¹ â€œç‹¬å¤„æ—¶çš„å®‰å…¨æ„Ÿâ€ã€‚åŒæ—¶ï¼Œå¯ä»¥è¦æ±‚ä¼´ä¾£ç»™ä½ ä¸€äº›å…·ä½“çš„ä¿è¯ï¼ˆæ¯”å¦‚çº¦å®šå›å®¶æ—¶é—´ï¼‰ï¼Œè¿™ä¸ä¸¢äººã€‚" },
    mid: { desc: "ä¼´ä¾£ä¸åœ¨çš„æ—¶å€™ï¼Œä½ ä¼šè§‰å¾—å¿ƒé‡Œç©ºè½è½çš„ã€‚", adv: "å»ºç«‹ä¸€äº›å±äºè‡ªå·±çš„çˆ±å¥½ï¼Œè®©è‡ªå·±å……å®èµ·æ¥ã€‚" },
    low: { desc: "ä½ æœ‰å¾ˆå¥½çš„å®‰å…¨æ„Ÿï¼Œä¿¡ä»»ä¼´ä¾£ä¼šå›æ¥ã€‚", adv: "ä½ çš„ä¿¡ä»»å¾ˆçè´µï¼Œä½†ä¹Ÿåˆ«å¿˜äº†è¡¨è¾¾ä½ çš„æƒ³å¿µã€‚" }
  },
  exclusion: {
    high: { desc: "ä½ æœ€å—ä¸äº†â€œä¸çŸ¥é“â€ã€‚å¦‚æœä»–ä»¬æœ‰ç§˜å¯†æˆ–ä½ å¬ä¸æ‡‚çš„æ¢—ï¼Œé‚£ç§â€œå±€å¤–äººâ€çš„æ„Ÿè§‰æ¯”èƒŒå›æ›´è®©ä½ éš¾å—ã€‚", adv: "ä½ å¯ä»¥å¦è¯šå‘Šè¯‰ä¼´ä¾£ï¼šâ€œæˆ‘ä¸éœ€è¦æ§åˆ¶ä½ ï¼Œæˆ‘åªæ˜¯æƒ³æœ‰ä¸€äº›å‚ä¸æ„Ÿã€‚â€åŒæ—¶å­¦ä¼šæ¥å—ä»–ä»¬æœ‰å±äºè‡ªå·±çš„å°ä¸–ç•Œã€‚" },
    mid: { desc: "ä½ ä¸å–œæ¬¢é‚£ç§è¢«è’™åœ¨é¼“é‡Œçš„æ„Ÿè§‰ã€‚", adv: "å’Œä¼´ä¾£çº¦å®šå¥½ä¿¡æ¯åŒæ­¥çš„ç¨‹åº¦ï¼Œå‡å°‘çŒœç–‘ã€‚" },
    low: { desc: "ä½ è§‰å¾—æ¯ä¸ªäººéƒ½æœ‰ç§˜å¯†å¾ˆæ­£å¸¸ï¼Œä¸æ€ä¹ˆçº ç»“ã€‚", adv: "ä¿æŒè¿™ç§è¾¹ç•Œæ„Ÿï¼Œè¿™ä¼šè®©å…³ç³»æ›´è½»æ¾ã€‚" }
  },
  territorial: {
    high: { desc: "ä½ è§‰å¾—å±äºä½ çš„æ—¶é—´ã€é‡‘é’±æˆ–ç©ºé—´è¢«æŠ¢èµ°äº†ã€‚åœ¨ä½ çœ‹æ¥ï¼Œçˆ±å°±åƒä¸€å—æœ‰é™çš„è›‹ç³•ï¼Œåˆ†ç»™åˆ«äººä½ å°±å°‘äº†ã€‚", adv: "è¯•ç€ä»â€œåŒ®ä¹å¿ƒæ€â€è½¬ä¸ºâ€œå¯Œè¶³å¿ƒæ€â€ã€‚è™½ç„¶æ—¶é—´æœ‰é™ï¼Œä½†çˆ±æ˜¯æ— é™çš„ã€‚ä½ å¯ä»¥è¦æ±‚ä¸€æ®µå®Œå…¨å±äºä½ çš„â€œé«˜è´¨é‡ç‹¬å æ—¶é—´â€ã€‚" },
    mid: { desc: "ä½ ä¸å–œæ¬¢åˆ«äººåŠ¨ä½ çš„ä¸œè¥¿æˆ–å ç”¨ä½ çš„æ—¶é—´ã€‚", adv: "æ˜ç¡®åˆ’å®šå“ªäº›æ˜¯ä½ çš„ç»å¯¹é¢†åŸŸï¼Œå“ªäº›å¯ä»¥åˆ†äº«ã€‚" },
    low: { desc: "ä½ å¾ˆå¤§æ–¹ï¼Œä¸å¤ªè®¡è¾ƒèµ„æºçš„åˆ†é…ã€‚", adv: "åªè¦è®°å¾—ç…§é¡¾å¥½è‡ªå·±çš„éœ€æ±‚ï¼Œåˆ«å§”å±ˆè‡ªå·±å°±è¡Œã€‚" }
  },
  projective: {
    high: { desc: "ä½ æ€€ç–‘ taï¼Œå…¶å®æ˜¯å› ä¸ºä½ å¿ƒé‡Œä¹Ÿæœ‰ç±»ä¼¼çš„æƒ³æ³•ã€‚ä¹Ÿè®¸æ˜¯ä½ å‹æŠ‘äº†æƒ³ç©çš„å†²åŠ¨ï¼Œæ‰€ä»¥è§‰å¾— ta è‚¯å®šä¹Ÿåœ¨ä¹±æ¥ã€‚", adv: "å¯¹è‡ªå·±è¯šå®ä¸€ç‚¹ï¼Œæ‰¿è®¤è‡ªå·±çš„æ¬²æœ›å¹¶ä¸å¯è€»ã€‚å½“ä½ æ¥çº³äº†è‡ªå·±å†…å¿ƒçš„â€œé˜´æš—é¢â€ï¼Œä½ å°±ä¸ä¼šæ€»æ˜¯æˆ´ç€æœ‰è‰²çœ¼é•œçœ‹ ta äº†ã€‚" },
    mid: { desc: "æœ‰æ—¶å€™ä½ ä¼šä»¥å·±åº¦äººï¼Œå»æ£æµ‹å¯¹æ–¹çš„åŠ¨æœºã€‚", adv: "ç›´æ¥å»é—® taï¼Œè€Œä¸æ˜¯åœ¨è„‘å­é‡Œæ¼”å†…å¿ƒæˆã€‚" },
    low: { desc: "ä½ å¾ˆå¦è¡ï¼Œç›¸ä¿¡ä¼´ä¾£çš„è¡Œä¸ºå°±æ˜¯å­—é¢æ„æ€ã€‚", adv: "ä¿æŒè¿™ç§ç®€å•ç›´æ¥çš„æ²Ÿé€šæ–¹å¼ã€‚" }
  }
};

const QUESTIONS = [
  {
    id: 1,
    title: "åœºæ™¯ï¼šå¼ºå¼±å¹¶å­˜çš„æ–°äºº",
    scenario: "ä¼´ä¾£å‘ä½ ä»‹ç»äº†æ–°å¯¹è±¡ã€‚ä½ å‘ç°è¿™ä¸ªäººåœ¨æŸäº›æ–¹é¢å¾ˆæœ‰å¸å¼•åŠ›ï¼ˆå¦‚å¹´è½»/å¤–è²Œï¼‰ï¼Œä½†åœ¨ç¤¾ä¼šåœ°ä½ã€æ”¶å…¥æˆ–å­¦å†ä¸Šæ˜æ˜¾ä¸å¦‚ä½ ã€‚",
    options: [
      { dim: 'competitive', text: "æ—¢ç„¶é€‰äº†é‚£ä¸€å‹ï¼Œè¯´æ˜åœ¨é‚£æ–¹é¢ï¼ˆå¦‚é’æ˜¥/å¤–è²Œï¼‰æˆ‘ç¡®å®è¾“äº†ï¼Œå¤±å»äº†ç«äº‰åŠ›ã€‚" },
      { dim: 'self_esteem', text: "çœ‹ä¸Šè¿™ç§æ¡£æ¬¡çš„äººï¼Ÿè¿™ä¾§é¢è¯´æ˜æˆ‘åœ¨ ta å¿ƒé‡Œä¹Ÿæ²¡å¤šé«˜è´µï¼Œç®€ç›´æ˜¯åœ¨æ‹‰ä½æˆ‘çš„èº«ä»·ã€‚" },
      { dim: 'normative', text: "è¿™ç§å·¨å¤§çš„é˜¶çº§/å¹´é¾„å·®ï¼Œè®©æˆ‘æœ¬èƒ½åœ°è§‰å¾—å……æ»¡åˆ©ç”¨è‰²å½©ï¼Œå¾ˆä¸é“å¾·ã€‚" },
      { dim: 'projective', text: "å…¶å®æˆ‘ä¹ŸæŒºæƒ³æ‰¾ä¸ªè¿™ç§å•çº¯æ¼‚äº®æ²¡èƒŒæ™¯çš„äººï¼Œta åªæ˜¯æŠŠæˆ‘æƒ³åšçš„åšå‡ºæ¥äº†ã€‚" },
      { dim: 'abandonment', text: "é‚£ä¸ªäººæœ‰æˆ‘å·²ç»å¤±å»çš„ç‰¹è´¨ï¼ˆå¦‚é’æ˜¥ï¼‰ï¼Œta ä¼šå› ä¸ºè´ªå›¾æ–°é²œæ„Ÿè€Œé€æ¸ç–è¿œæˆ‘ã€‚" }
    ]
  },
  {
    id: 2,
    title: "åœºæ™¯ï¼šçº¦ä¼šåçš„é«˜èƒ½é‡",
    scenario: "ä¼´ä¾£çº¦ä¼šå›æ¥ï¼ŒçŠ¶æ€æ˜æ˜¾æ¯”å¹³æ—¶å¥½å¾ˆå¤šï¼Œç”šè‡³æ¯”å’Œä½ åœ¨ä¸€èµ·æ—¶æ˜¾å¾—æ›´å¼€å¿ƒã€æ›´æœ‰æ´»åŠ›ã€‚",
    options: [
      { dim: 'exclusion', text: "ä»–ä»¬è‚¯å®šå‘ç”Ÿäº†ä»€ä¹ˆæˆ‘ä¸çŸ¥é“çš„å¥½äº‹ï¼Œæˆ‘åƒä¸ªå±€å¤–äººè¢«éš”ç»åœ¨å¿«ä¹ä¹‹å¤–ã€‚" },
      { dim: 'competitive', text: "é‚£ä¸ªäººä¸€å®šæ¯”æˆ‘æ›´æœ‰è¶£æˆ–â€œæ´»å„¿â€æ›´å¥½ï¼Œæ‰èƒ½è®© ta è·å¾—è¿™ç§æ»¡è¶³æ„Ÿã€‚" },
      { dim: 'territorial', text: "æŠŠå¥½æƒ…ç»ªéƒ½åœ¨å¤–é¢è€—å°½äº†ï¼Œç•™ç»™æˆ‘çš„åªå‰©ç–²æƒ«ï¼Œè¿™æ˜¯ä¾µå äº†æˆ‘çš„ä»½é¢ã€‚" },
      { dim: 'normative', text: "åˆšä»åˆ«äººæ€€é‡Œå›æ¥è¿˜è¿™ä¹ˆé«˜å…´ï¼Œè¿èƒŒäº†äº²å¯†å…³ç³»çš„æ’ä»–æœ¬èƒ½ï¼Œè®©æˆ‘ç”Ÿç†æ€§æ¶å¿ƒã€‚" },
      { dim: 'abandonment', text: "Ta é‚£ä¹ˆå¼€å¿ƒï¼Œè¯´æ˜æ²¡æœ‰æˆ‘ä¹Ÿå¯ä»¥è¿‡å¾—å¾ˆå¥½â€¦â€¦è¿™è®©æˆ‘æ„Ÿåˆ°è‡ªå·±æ˜¯å¤šä½™çš„ã€‚" }
    ]
  },
  {
    id: 3,
    title: "åœºæ™¯ï¼šæ‰‹æœºé¿å«Œ",
    scenario: "ä½ ä»¬ååœ¨ä¸€èµ·ï¼Œä¼´ä¾£çš„æ‰‹æœºå“äº†ï¼Œä½ ä»¬éƒ½æ„è¯†åˆ°æ˜¯å¤–é¢çš„æ–°äººå‘æ¥çš„ã€‚æ­¤æ—¶ ta é€‰æ‹©æ‰¾ä¸ªä½ çœ‹ä¸åˆ°çš„åœ°æ–¹ï¼ˆå¦‚ä¾§è¿‡èº«ï¼‰å›å¤æ¶ˆæ¯ã€‚",
    options: [
      { dim: 'exclusion', text: "è¿™ç§åˆ»æ„å»ºç«‹â€œç§˜å¯†å°ä¸–ç•Œâ€çš„è¡Œä¸ºï¼Œæ¯”çœŸåšäº†ä»€ä¹ˆæ›´è®©æˆ‘éš¾å—ï¼Œè®¨åŒè¢«è’™åœ¨é¼“é‡Œã€‚" },
      { dim: 'projective', text: "é®é®æ©æ©å¾€å¾€æ„å‘³ç€å¿ƒé‡Œæœ‰é¬¼ï¼Œå°±åƒæˆ‘æœ‰ç§˜å¯†ä¸æƒ³è®© ta çŸ¥é“æ—¶ä¸€æ ·ã€‚" },
      { dim: 'territorial', text: "ç°åœ¨æ˜¯å±äºæˆ‘ä»¬çš„é™ªä¼´æ—¶é—´ï¼Œta å´åœ¨å›åº”åˆ«äººï¼Œè¿™æ˜¯ç›—ç”¨å…±åŒæ—¶é—´ã€‚" },
      { dim: 'competitive', text: "æ­¤åˆ» ta æ›´åœ¨æ„é‚£ä¸ªäººã€‚åœ¨é‚£ä¸ªäººé¢å‰ï¼Œæˆ‘è¢«æ¯”ä¸‹å»äº†ã€‚" },
      { dim: 'self_esteem', text: "å½“é¢é˜²ç€æˆ‘ï¼Œæ˜¯ä¸ä¿¡ä»»çš„è¡¨ç°ï¼Œè®©æˆ‘è§‰å¾—è‡ªå·±åƒä¸ªå¤–äººï¼Œå¾ˆä¼¤è‡ªå°Šã€‚" }
    ]
  },
  {
    id: 4,
    title: "åœºæ™¯ï¼šèµ„æºçš„å€¾æ–œ",
    scenario: "ä½ å‘ç°ä¸ºäº†ç»™æ–°å¯¹è±¡åº†ç¥ç”Ÿæ—¥ï¼Œta è¡¨ç°å¾—éå¸¸ç”¨å¿ƒï¼ˆå‡†å¤‡æ˜‚è´µç¤¼ç‰©æˆ–ç­–åˆ’å¤æ‚è¡Œç¨‹ï¼‰ï¼Œä¼¼ä¹å¾ˆä¹…æ²¡æœ‰å¯¹ä½ è¿™ä¹ˆç”¨å¿ƒäº†ã€‚",
    options: [
      { dim: 'territorial', text: "æ— è®ºæ˜¯é’±è¿˜æ˜¯ç²¾åŠ›ï¼Œè¿™æœ¬è¯¥æ˜¯ç”¨äºå»ºè®¾æˆ‘ä»¬å…³ç³»çš„èµ„æºï¼Œä¸è¯¥å¤–æµã€‚" },
      { dim: 'self_esteem', text: "å¯¹å¤–äººé‚£ä¹ˆéš†é‡ï¼Œå¯¹æˆ‘å°±è¿™ä¹ˆéšä¾¿ï¼Ÿè§‰å¾—æˆ‘ä¸å€¼é’±ï¼Œåœ°ä½å—åˆ°äº†è½»è§†ã€‚" },
      { dim: 'normative', text: "äº²å¯†å…³ç³»åº”æœ‰ä¸»æ¬¡ã€‚æŠŠé«˜è§„æ ¼å¾…é‡ç»™æ¬¡è¦ä¼´ä¾£ï¼Œæ‰“ç ´äº†â€œåšæ­¤è–„å½¼â€çš„è§„çŸ©ã€‚" },
      { dim: 'competitive', text: "è¡ŒåŠ¨è¯æ˜ä¸€åˆ‡ï¼Œta æ˜¾ç„¶æ›´çˆ±é‚£ä¸ªäººã€‚æˆ‘åœ¨ ta å¿ƒé‡Œçš„æ’åä¸‹é™äº†ã€‚" },
      { dim: 'projective', text: "æˆ‘å¹³æ—¶ä¸ºäº†é¡¾å®¶å‹æŠ‘äº†æ¶ˆè´¹å†²åŠ¨ï¼Œta å‡­ä»€ä¹ˆå°±å¯ä»¥è¿™ä¹ˆæ”¾è‚†åœ°æŒ¥éœï¼Ÿ" }
    ]
  },
  {
    id: 5,
    title: "åœºæ™¯ï¼šæ€§ä½“éªŒçš„å·®å¼‚",
    scenario: "ä¼´ä¾£æ— æ„ä¸­é€éœ²ï¼Œæ–°å¯¹è±¡åœ¨åºŠä¸Šæœ‰ä¸€äº›ä½ æ²¡æœ‰çš„ç‰¹è´¨ï¼ˆå¦‚æ›´ç‹‚é‡ã€æˆ–æœ‰ç‰¹æ®Šç™–å¥½ï¼‰ï¼Œè®© ta ä½“éªŒåˆ°äº†ä¸åŒçš„å¿«æ„Ÿã€‚",
    options: [
      { dim: 'normative', text: "é‚£äº›ç©æ³•å¤ªå‡ºæ ¼/å¤ªè„äº†ã€‚è¿™ç§â€œæ·«ä¹±â€ç”»é£è®©æˆ‘è§‰å¾—ç¾è€»ã€‚" },
      { dim: 'competitive', text: "åŸæ¥ ta å–œæ¬¢é‚£ç§ï¼Ÿé‚£æˆ‘æ˜¯ä¸æ˜¯å¤ªæ— è¶£äº†ï¼Ÿæ‹…å¿ƒå› æ­¤å¯¹ ta å¤±å»æ€§å¸å¼•åŠ›ã€‚" },
      { dim: 'exclusion', text: "ä½ ä»¬åœ¨æ€§ä¸Šå»ºç«‹äº†æŸç§æˆ‘æ— æ³•ä»‹å…¥çš„ç‰¹æ®Šè¿æ¥ï¼Œè¿™è®©æˆ‘è§‰å¾—è‡ªå·±æ˜¯ä¸å®Œæ•´çš„ã€‚" },
      { dim: 'projective', text: "å¬å¾—æˆ‘éƒ½å¿ƒåŠ¨äº†ã€‚å…¶å®æˆ‘ä¹Ÿæƒ³ç©ç‚¹åˆºæ¿€çš„ï¼Œä¸å…¶è¯´æ˜¯å«‰å¦’ï¼Œä¸å¦‚è¯´æ˜¯ç¾¡æ…•ã€‚" },
      { dim: 'abandonment', text: "æ€§æ˜¯æƒ…æ„Ÿçš„ç²˜åˆå‰‚ã€‚èº«ä½“æ›´å¥‘åˆï¼Œè¿Ÿæ—©ä¼šæŠŠ ta çš„å¿ƒä¹Ÿå¸¦èµ°ã€‚" }
    ]
  },
  {
    id: 6,
    title: "åœºæ™¯ï¼šç¤¾äº¤åœˆçš„æµè¨€",
    scenario: "ä½ å‘ç°ä½ ä»¬å…±åŒçš„æœ‹å‹åœˆé‡Œï¼ˆå¦‚æœ‹å‹ç¾¤æˆ–ç†Ÿäººï¼‰ï¼Œä¼¼ä¹æœ‰äººçŸ¥é“äº†taæœ‰æ–°å¯¹è±¡è¿™ä»¶äº‹ï¼Œå¹¶å¯¹æ­¤æœ‰ä¸€äº›è®®è®ºã€‚",
    options: [
      { dim: 'self_esteem', text: "è¿™è®©æˆ‘å¾ˆæ²¡é¢å­ã€‚å¤§å®¶ä¼šè§‰å¾—æˆ‘ç®¡ä¸ä½ä¼´ä¾£ï¼Œæˆ–è€…è½¯å¼±/è¢«ç»¿ï¼ŒæŸå®³ç¤¾ä¼šå½¢è±¡ã€‚" },
      { dim: 'territorial', text: "æˆ‘ä»¬çš„å…³ç³»æ˜¯ç§äº‹ã€‚è®©å¤–äººçŸ¥é“å¹¶è¯„å¤´è®ºè¶³ï¼Œä¾µçŠ¯äº†æˆ‘çš„éšç§è¾¹ç•Œã€‚" },
      { dim: 'normative', text: "å…³èµ·é—¨æ€ä¹ˆç©éƒ½è¡Œï¼Œé—¹å¾—äººå°½çš†çŸ¥å°±æ˜¯ä¼¤é£è´¥ä¿—ï¼Œç ´åäº†ä½“é¢ã€‚" },
      { dim: 'exclusion', text: "åˆ«äººéƒ½çŸ¥é“äº†ï¼Œæˆ‘å´æ˜¯æœ€åçŸ¥é“ï¼ˆæˆ–æ— æ³•æ§åˆ¶ä¼ æ’­ï¼‰çš„äººï¼Œå¤±å»äº†æŒæ§æ„Ÿã€‚" },
      { dim: 'competitive', text: "å¤§å®¶è‚¯å®šåœ¨æ‹¿æˆ‘å’Œé‚£ä¸ªæ–°äººæ¯”è¾ƒã€‚ä¸‡ä¸€è§‰å¾—é‚£ä¸ªäººæ¯”æˆ‘æ›´é€‚åˆ taï¼Œæˆ‘å°±ä¸‹ä¸æ¥å°äº†ã€‚" }
    ]
  },
  {
    id: 7,
    title: "åœºæ™¯ï¼šå½“ä½ è„†å¼±æ—¶",
    scenario: "ä½ ç”Ÿç—…äº†æˆ–å¿ƒæƒ…ä½è½ï¼Œä½†ä¼´ä¾£æ—©å°±å’Œæ–°äººçº¦å¥½äº†å‡ºé—¨ã€‚Ta çŠ¹è±«äº†ä¸€ä¸‹ï¼Œè¿˜æ˜¯å†³å®šæŒ‰åŸè®¡åˆ’å»çº¦ä¼šï¼Œåªç•™ç»™ä½ åŸºæœ¬çš„ç…§é¡¾ã€‚",
    options: [
      { dim: 'abandonment', text: "æœ€éœ€è¦ ta çš„æ—¶å€™ ta é€‰æ‹©äº†åˆ«äººã€‚è¯æ˜æˆ‘ä¸æ˜¯ç¬¬ä¸€ä½ï¼Œæˆ‘æ˜¯è¢«æŠ›å¼ƒçš„ã€‚" },
      { dim: 'normative', text: "ç…§é¡¾ç”Ÿç—…ä¼´ä¾£æ˜¯åŸºæœ¬è´£ä»»ã€‚Ta è¿™ä¹ˆåšå°±æ˜¯è‡ªç§ã€å†·è¡€ã€ä¸è´Ÿè´£ä»»ã€‚" },
      { dim: 'territorial', text: "æˆ‘ç°åœ¨çš„çŠ¶æ€éœ€è¦äººé™ªï¼Œè¿™æ˜¯ä½œä¸ºä¼´ä¾£åº”å¾—çš„æƒç›Šï¼Œä¸è¯¥è¢«å…‹æ‰£ã€‚" },
      { dim: 'self_esteem', text: "ä¸ºäº†é‡è¦å…¬äº‹ä¹Ÿå°±ç®—äº†ï¼Œä¸ºäº†çº¦ä¼šä¸¢ä¸‹ç”Ÿç—…çš„æˆ‘ï¼Ÿæˆ‘åœ¨ä½ å¿ƒé‡Œå°±è¿™ä¹ˆä¸å€¼é’±ï¼Ÿ" },
      { dim: 'projective', text: "æ¢ä½œæ˜¯æˆ‘ï¼Œå¦‚æœ ta ç”Ÿç—…æˆ‘æƒ³å»çº¦ä¼šï¼Œå¯èƒ½ä¹Ÿä¼šæƒ³æºœã€‚ä½†æˆ‘ä¸æ•¢ï¼Œta ç«Ÿç„¶çœŸæ•¢ã€‚" }
    ]
  },
  {
    id: 8,
    title: "åœºæ™¯ï¼šé£æ ¼çš„å†²çª",
    scenario: "ä½ å‘ç°æ–°å¯¹è±¡æ˜¯ä¸€ä¸ªå’Œä½ é£æ ¼å®Œå…¨ç›¸åçš„äººã€‚æ¯”å¦‚ä½ å¾ˆç²¾è‡´ä¸Šè¿›ï¼Œé‚£ä¸ªäººå´å¾ˆæ•£æ¼«é¢“åºŸï¼ˆæˆ–è€…åä¹‹ï¼‰ã€‚",
    options: [
      { dim: 'self_esteem', text: "æ‰¾è¿™ç§äººè¯´æ˜ ta å“å‘³ä¹Ÿå°±é‚£æ ·ã€‚è¿™ä¸ä»…å¦å®š ta è‡ªå·±ï¼Œä¹Ÿé—´æ¥æ‹‰ä½äº†æˆ‘çš„æ¡£æ¬¡ã€‚" },
      { dim: 'competitive', text: "åŸæ¥ ta å†…å¿ƒæ·±å¤„å–œæ¬¢é‚£ç§ç±»å‹ï¼Ÿé‚£æˆ‘è¿™äº›å¹´ç»´æŒçš„å½¢è±¡ç®—ä»€ä¹ˆï¼Ÿæˆ‘ä¸æ˜¯ç†æƒ³å‹ï¼Ÿ" },
      { dim: 'projective', text: "å…¶å®æˆ‘æ½œæ„è¯†é‡Œä¹Ÿæƒ³æ´»æˆé‚£æ ·ã€‚Ta æ‰¾é‚£ä¸ªäººï¼Œè¡¥å…¨äº†æˆ‘ä»¬å…³ç³»é‡Œå‹æŠ‘çš„é‚£ä¸€å—ã€‚" },
      { dim: 'exclusion', text: "ä»–ä»¬é‚£ä¸ªåœˆå­çš„æ°›å›´æ˜¯æˆ‘å®Œå…¨æ’ä¸ä¸Šå˜´çš„ã€‚ä»–ä»¬å¤„äºä¸€ä¸ªæˆ‘æ— æ³•ç†è§£çš„ä¸–ç•Œé‡Œã€‚" },
      { dim: 'normative', text: "è¿™ç§ç±»å‹çš„äººä¸€çœ‹å°±ä¸é è°±ã€‚æ‹…å¿ƒä¼´ä¾£è¢«éª—ï¼Œæˆ–è€…æ²¾æŸ“ä¸Šä¸å¥½çš„ä¹ æ°”ã€‚" }
    ]
  },
  {
    id: 9,
    title: "åœºæ™¯ï¼šæ·±åº¦å…±é¸£",
    scenario: "ä½ çœ‹åˆ°ä»–ä»¬æ­£åœ¨æ·±å…¥æ¢è®¨ä¸€ä¸ªä½ å®Œå…¨ä¸æ„Ÿå…´è¶£ã€æˆ–è€…å¬ä¸æ‡‚çš„è¯é¢˜ï¼ˆå¦‚æŸä¸ªæ¸¸æˆã€ä¸“ä¸šé¢†åŸŸï¼‰ï¼Œä¸¤äººæ˜¾å¾—æå…¶é»˜å¥‘ã€‚",
    options: [
      { dim: 'exclusion', text: "é‚£ç§â€œåªæœ‰æˆ‘ä»¬æ‡‚â€çš„æ°›å›´è®©æˆ‘éš¾å—ã€‚æˆ‘åƒä¸ªå‚»ç“œè¢«éš”ç»åœ¨ä»–ä»¬çš„ç²¾ç¥ä¸–ç•Œä¹‹å¤–ã€‚" },
      { dim: 'abandonment', text: "èº«ä½“èƒŒå›èƒ½å¿ï¼Œè¿™ç§çµé­‚å¥‘åˆè®©æˆ‘è§‰å¾—å½»åº•å¤±å»äº† taã€‚è¿™ç§è¿æ¥æ— æ³•æ›¿ä»£ã€‚" },
      { dim: 'competitive', text: "æˆ‘ä»¥ä¸ºæˆ‘æ‰æ˜¯æœ€æ‡‚ ta çš„äººã€‚ç°åœ¨å‡ºç°äº†æ›´æ‡‚çš„äººï¼Œæˆ‘â€œçµé­‚ä¼´ä¾£â€çš„ä½ç½®ä¸ä¿ã€‚" },
      { dim: 'self_esteem', text: "èŠé‚£äº›æ˜¾å¾—å¾ˆé«˜æ·±ï¼Œæ˜¯åœ¨æ˜¾æ‘†å—ï¼Ÿè®©æˆ‘è§‰å¾—è‡ªå·±æ— çŸ¥ã€æµ…è–„ï¼Œå¾ˆä¼¤è‡ªå°Šã€‚" },
      { dim: 'projective', text: "çœŸç¾¡æ…•èƒ½èŠè¿™äº›ã€‚å…¶å®æˆ‘ä¹Ÿæƒ³æ‰¾ä¸ªèƒ½èŠå¾—æ¥çš„ï¼Œè€Œä¸æ˜¯åªèƒ½å’Œä¼´ä¾£èŠæŸ´ç±³æ²¹ç›ã€‚" }
    ]
  },
  {
    id: 10,
    title: "åœºæ™¯ï¼šèŠ‚æ—¥çš„åˆ†é…",
    scenario: "æƒ…äººèŠ‚å¿«åˆ°äº†ã€‚ä¼´ä¾£æå‡ºï¼Œæƒ³æŠŠæƒ…äººèŠ‚æ‹†æˆä¸¤åŠï¼Œç™½å¤©é™ªä½ ï¼Œæ™šä¸Šå»é™ªæ–°å¯¹è±¡ï¼ˆæˆ–è€…åä¹‹ï¼‰ã€‚",
    options: [
      { dim: 'normative', text: "æƒ…äººèŠ‚æ˜¯å±äºâ€œä¸€å¯¹â€ä¼´ä¾£çš„ã€‚æŠŠå®ƒæ‹†åˆ†æ˜¯å¯¹å…³ç³»çš„äºµæ¸ï¼Œè¿èƒŒäº†çˆ±çš„å®šä¹‰ã€‚" },
      { dim: 'territorial', text: "ä¸ç®¡ç™½å¤©æ™šä¸Šï¼Œè¿™ä¸€æ•´å¤©çš„æ—¶é—´ä¸»æƒéƒ½åº”è¯¥æ˜¯æˆ‘çš„ï¼Œä¸æ¥å—ä»»ä½•â€œå…±äº«â€ã€‚" },
      { dim: 'self_esteem', text: "å¦‚æœè®©äººçŸ¥é“æˆ‘æƒ…äººèŠ‚åªèƒ½åˆ†åˆ°åŠå¤©ï¼Œè¿˜è¦ä¸è¦é¢å­ï¼Ÿåƒä¸ªâ€œå…¼èŒâ€ä¼´ä¾£ã€‚" },
      { dim: 'competitive', text: "ä¸ºä»€ä¹ˆè¦åˆ†ï¼Ÿæ˜¯å› ä¸ºåªé™ªæˆ‘ä¸å¤Ÿæ»¡è¶³å—ï¼Ÿæˆ‘ä»¬åœ¨ ta å¿ƒé‡Œåˆ°åº•è°æ›´é‡è¦ï¼Ÿ" },
      { dim: 'abandonment', text: "ä»Šå¤©åˆ†åŠå¤©ï¼Œæ˜å¤©å°±åˆ†å…¨å¤©ï¼Ÿè¿™ç§è¾¹ç•Œé€€è®©è®©æˆ‘ä¸å®‰å…¨ï¼Œæ„Ÿè§‰å…³ç³»åœ¨è¢«èš•é£Ÿã€‚" }
    ]
  }
];

// =====================================================================
// 2. ä¸»ç»„ä»¶ (JealousyQuiz)
// =====================================================================

const Jealousy = () => {
  const [started, setStarted] = useState(false);
  const [showResult, setShowResult] = useState(false);
  const [scores, setScores] = useState({});
  const [activeDim, setActiveDim] = useState(null);

  const handleStart = () => {
    setStarted(true);
    window.scrollTo(0, 0);
  };

  const handleFinish = (answers) => {
    const raw = {};
    Object.keys(DIMENSIONS).forEach(k => raw[k] = 0);
    
    // è®¡ç®—åˆ†æ•°: Primary = 3, Secondary = 1
    Object.values(answers).forEach(ans => {
      if (ans.primary && DIMENSIONS[ans.primary]) raw[ans.primary] += 3;
      if (ans.secondary && ans.secondary.length) {
        ans.secondary.forEach(dim => {
          if (DIMENSIONS[dim]) raw[dim] += 1;
        });
      }
    });

    setScores(raw);
    setShowResult(true);
    window.scrollTo(0, 0);
  };

  const handleRetry = () => {
    setStarted(false);
    setShowResult(false);
    setScores({});
    window.scrollTo(0, 0);
  };

  // ç”Ÿæˆç»“æœå±•ç¤ºé¡¹ (æŒ‰åˆ†æ•°æ’åº)
  const sortedResultItems = useMemo(() => {
    if (!showResult) return [];
    return Object.keys(scores)
      .sort((a, b) => scores[b] - scores[a])
      .map(key => {
        const val = scores[key];
        // åˆ¤å®šç­‰çº§: >=6 High, >=2 Mid, else Low
        let level = 'low';
        if (val >= 6) level = 'high';
        else if (val >= 2) level = 'mid';
        
        return {
          key,
          score: val,
          label: DIMENSIONS[key].name,
          desc: DIMENSIONS[key].desc,
          content: FEEDBACK_DATA[key][level].desc,
          advice: FEEDBACK_DATA[key][level].adv
        };
      });
  }, [scores, showResult]);

  const dominantItem = sortedResultItems.length > 0 && sortedResultItems[0].score > 2 
    ? sortedResultItems[0] 
    : null;

  if (!started) return (
    <QuizContainer>
      <WelcomeCard 
        title="å«‰å¦’ç±»å‹å›¾è°±"
        introList={[
          "å«‰å¦’ä¸æ˜¯ä¸€ç§å•ä¸€æƒ…ç»ªï¼Œè€Œæ˜¯å†…å¿ƒéœ€æ±‚çš„ä¿¡å·ç¯ã€‚",
          "é€šè¿‡ 10 ä¸ªå…¸å‹åœºæ™¯ï¼Œæ¢ç´¢ä½ åœ¨äº²å¯†å…³ç³»ä¸­çš„â€œå«‰å¦’åŸå‹â€ã€‚",
          "æˆ‘ä»¬å°†åˆ†æä½ æ˜¯æ›´å®³æ€•â€œè¢«æŠ›å¼ƒâ€ã€æ›´åœ¨æ„â€œè¾“èµ¢â€ï¼Œè¿˜æ˜¯è§‰å¾—â€œä¸¢é¢å­â€ã€‚",
          "ä½œç­”æ–¹å¼ï¼šæ¯é¢˜åˆ†ä¸¤æ­¥ï¼Œå…ˆé€‰â€œæœ€ç—›ç‚¹â€ï¼Œå†é€‰â€œå…±é¸£ç‚¹â€ã€‚"
        ]}
        onStart={handleStart}
      />
      <QuizFooter currentId="jealousy" />
    </QuizContainer>
  );

  if (showResult) {
    return (
      <QuizContainer>
        {/* 1. ä¸»å¯¼åŸå‹å¡ç‰‡ */}
        <ScoreCard 
          title="æ‚¨çš„ä¸»å¯¼å«‰å¦’åŸå‹" 
          theme="dark" 
          variant="hero"
        >
          {dominantItem ? (
            <>
              <div style={{ fontSize: '3rem', fontWeight: '900', color: '#fbbf24', lineHeight: 1, marginBottom: '0.5rem' }}>
                {dominantItem.label}
              </div>
              <div style={{ fontSize: '1.2rem', color: '#d4d4d8', marginBottom: '1.5rem' }}>
                {dominantItem.desc}
              </div>
              <div style={{ textAlign: 'left', padding: '0 0.5rem' }}>
                <p style={{ color: '#f4f4f5', fontSize: '1rem', lineHeight: 1.6, marginBottom: '1rem' }}>
                  <span style={{ color: '#fbbf24', fontWeight:'bold' }}>âœ¦ è¯Šæ–­ï¼š</span>
                  {dominantItem.content}
                </p>
                <p style={{ color: '#d4d4d8', fontSize: '0.95rem', lineHeight: 1.6 }}>
                  <span style={{ color: '#fbbf24', fontWeight:'bold' }}>âœ¦ å»ºè®®ï¼š</span>
                  {dominantItem.advice}
                </p>
              </div>
            </>
          ) : (
            <>
              <div style={{ fontSize: '3rem', fontWeight: '900', color: '#fbbf24', marginBottom: '1rem' }}>å¹³ç¨³å‹</div>
              <div style={{ textAlign: 'left', color: '#d4d4d8' }}>
                æ‚¨çš„å«‰å¦’ååº”å¾®å¼±ï¼Œæ‹¥æœ‰æé«˜çš„å®‰å…¨æ„Ÿã€‚è¯·ç¡®è®¤è¿™æ˜¯â€œä¿¡ä»»â€è€Œéâ€œä¸åœ¨ä¹â€ï¼Œå¹¶ç»§ç»­ä¿æŒè¿™ç§ç‹¬ç«‹è±è¾¾ã€‚
              </div>
            </>
          )}
        </ScoreCard>

        {/* 2. é›·è¾¾å›¾ */}
        <RadarChart 
          dimensions={DIMENSIONS}
          scores={scores}
          activeDim={activeDim || (dominantItem ? dominantItem.key : sortedResultItems[0]?.key)}
          onDimClick={setActiveDim}
          maxVal={12}
        />

        {/* 3. è¯¦ç»†åˆ†æ (ä½¿ç”¨ ResultAnalysis æ™ºèƒ½æŠ˜å ) */}
        <ResultAnalysis 
          title="å…¨ç»´åº¦æ·±åº¦è§£æ"
          threshold={5.0} // >=5 åˆ†ç®—æ˜¾è‘—
          items={sortedResultItems.map(d => ({
            label: d.label,
            score: `${d.score}åˆ†`,
            content: (
              <>
                {d.content}
                <br/>
                <span style={{ display:'block', marginTop:'0.5rem', color:'var(--qz-primary)', fontWeight:'bold' }}>
                  ğŸ’¡ {d.advice}
                </span>
              </>
            )
          }))}
        />

        <ResultActions onRetry={handleRetry} />
        <QuizFooter currentId="jealousy" status="result" />
      </QuizContainer>
    );
  }

  // ç­”é¢˜éƒ¨åˆ†
  return (
    <QuizContainer>
      <CaseReactionPager 
        questions={QUESTIONS} 
        onFinish={handleFinish} 
        quizId="jealousy" // å¯ç”¨æœ¬åœ°å­˜å‚¨åŠŸèƒ½
      />
    </QuizContainer>
  );
};

export default Jealousy;