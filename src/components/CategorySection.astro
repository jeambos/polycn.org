---
/* src/components/CategorySection.astro */
import RecentUpdates from './RecentUpdates.astro';

interface Props {
  title: string;
  idPrefix: string;
  featured: {
    title: string;
    description: string;
    link: string;
    tag?: string;
    image?: string;
  };
}

const { title, idPrefix, featured } = Astro.props;
---

<div class="category-section">
  <h2 class="section-title">{title}</h2>
  
  <div class="section-grid">
    {/* 左侧：特色推荐卡片 */}
    <a href={featured.link} class="featured-card">
      {/* 1. 左侧：装饰性封面条 (20% 宽度) */}
      <div 
        class="card-cover" 
        style={featured.image ? `background-image: url(${featured.image});` : ''}
      >
      </div>

      {/* 2. 右侧：内容区域 */}
      <div class="card-content">
        
        {/* (已删除右上角标签区域) */}
        
        <div class="text-group">
          <h3 class="featured-title">{featured.title}</h3>
          <p class="featured-desc">{featured.description}</p>
        </div>
        
        {/* 底部链接：右对齐 + 变大 */}
        <div class="featured-footer">
          立即阅读 &rarr;
        </div>
      </div>
    </a>

    {/* 右侧：该分类下的最近更新 */}
    <div class="updates-wrapper">
      <RecentUpdates idPrefix={idPrefix} />
    </div>
  </div>
</div>

<style>
  .category-section {
    margin-bottom: 4rem;
  }

  .section-title {
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 1.5rem;

  }

  /* --- 整体 Grid 布局 --- */
  .section-grid {
    display: grid;
    grid-template-columns: 100%; 
    gap: 1.5rem;
    width: 100%;
  }

  /* 桌面端 (>= 768px) */
  @media (min-width: 768px) {
    .section-grid {
      grid-template-columns: 1.5fr 1fr;
    }
  }

  /* --- 特色卡片样式 --- */
  .featured-card {
    display: flex;
    flex-direction: row; 
    
    background: var(--sl-color-gray-6);
    border: 1px solid var(--sl-color-gray-5);
    border-radius: 16px;
    text-decoration: none;
    overflow: hidden;
    transition: transform 0.2s, border-color 0.2s;
    
    min-height: 220px;
    min-width: 0; 
  }

  .featured-card:hover {
    transform: translateY(-2px);
    border-color: var(--sl-color-accent);
  }

  /* 左侧装饰条 */
  .card-cover {
    flex: 0 0 20%; 
    background-size: cover;
    background-position: center;
    background-color: var(--sl-color-black);
    border-right: 1px solid var(--sl-color-gray-5);
    
    @media (max-width: 640px) {
      flex: 0 0 25%;
    }
  }

  /* 右侧内容区 */
  .card-content {
    flex: 1; 
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    padding: 1.5rem;
    
    @media (max-width: 640px) {
      padding: 1rem;
    }
  }

  .text-group {
    margin-bottom: 1rem;
  }

  .featured-title {
    font-size: 1.4rem !important;
    margin: 0 0 0.8rem 0 !important;
    color: var(--sl-color-white);
    line-height: 1.25;
  }

  .featured-desc {
    color: var(--sl-color-gray-3);
    line-height: 1.6;
    margin-bottom: 0; /* 这里的下边距交给 flex 的 justify-content 处理 */
    font-size: 0.95rem;
    
    display: -webkit-box;
    -webkit-line-clamp: 4;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .featured-footer {
    color: var(--sl-color-accent);
    font-weight: bold;
    
    /* ✅ 修改点：变大 + 右对齐 */
    font-size: 1.25rem; 
    align-self: flex-end; /* 在 flex column 中实现右对齐 */
    
    margin-top: 1rem; /* 保证与上方文字有一定间距 */
  }

  /* --- 右侧更新列表容器 --- */
  .updates-wrapper {
    min-width: 0;
    height: 100%;
  }
</style>